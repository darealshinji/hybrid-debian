#!/bin/sh

if test x"$1" = x"-h" -o x"$1" = x"--help" ; then
cat << EOF
Usage: ./configure [options]

options:
  -h, --help               print this message
  --prefix=PREFIX          install files into PREFIX [/usr/local]
  --with-bdsup2sub-jar     Let the startup script check for Java and
                           download BDSup2Sub.jar if the system can't
                           use bdsup2sub++ because it doesn't support
                           c++11.
EOF
exit 1
fi

JAVA="no"
for opt; do
    optarg="${opt#*=}"
    case "$opt" in
        --prefix=*)
            prefix="$optarg"
            ;;
        --with-bdsup2sub-jar)
            JAVA="yes"
            ;;
        *)
            ;;
    esac
done

test -n "$prefix" || prefix="/usr/local"

rm -f Makefile
cat >> Makefile << EOF
prefix = $prefix
JAVA = $JAVA
EOF
cat Makefile.in >> Makefile

rm -f hybrid
cat >> hybrid << EOF
#!/bin/sh
QT=48
prefix=$prefix
EOF
cat hybrid.in >> hybrid

rm -f hybrid-qt5
cat >> hybrid-qt5 << EOF
#!/bin/sh
QT=521
prefix=$prefix
EOF
cat hybrid.in >> hybrid-qt5

echo "prefix: $prefix"
echo "with BDSup2Sub.jar: $JAVA"
echo "Now run 'make && make install'"

exit 0
